# ğŸ± çŒ«çŒ«å’–å•¡å±‹ - Multi-Agent è°ƒåº¦å™¨

ä¸€ä¸ªåŸºäº Go çš„å¤š Agent åä½œå¼€å‘ç³»ç»Ÿï¼Œç”±ä¸‰åªå¯çˆ±çš„çŒ«å’ª Agent ç»„æˆã€‚

## ğŸ­ çŒ«å’ªå›¢é˜Ÿ

- **ğŸ± ä¸‰èŠ±çŒ«Â·èŠ±èŠ±** (Claude Opus) - ä¸»æ¶æ„å¸ˆ & æ ¸å¿ƒå¼€å‘
- **ğŸ± ç‹¸èŠ±çŒ«Â·è–‡è–‡** (Codex) - ä»£ç å®¡æŸ¥ & å®‰å…¨æµ‹è¯•
- **ğŸ± é“¶æ¸å±‚Â·å°ä¹”** (Gemini) - è§†è§‰è®¾è®¡

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
# å®‰è£… Redis
brew install redis

# ä¸‹è½½ Go ä¾èµ–
go mod download
```

### 2. ç¼–è¯‘

```bash
make build
```

### 3. å¯åŠ¨ Redis

```bash
redis-server --daemonize yes
```

### 4. ä½¿ç”¨

#### æ–¹å¼ä¸€ï¼šä¸€é”®å¯åŠ¨ï¼ˆæ¨èï¼‰

ä½¿ç”¨ä¾¿æ·è„šæœ¬å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆAPI Server + æ‰€æœ‰ Agentï¼‰ï¼š

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
./start.sh

# åœæ­¢æ‰€æœ‰æœåŠ¡
./stop.sh
```

å¯åŠ¨åï¼š
- API æœåŠ¡å™¨è¿è¡Œåœ¨ `http://localhost:8080`
- æ‰€æœ‰çŒ«çŒ« Agent è‡ªåŠ¨å¯åŠ¨å¹¶ç­‰å¾…ä»»åŠ¡
- å¯ä»¥é€šè¿‡ API æˆ–å‰ç«¯ç•Œé¢ä¸çŒ«çŒ«ä»¬äº¤äº’

#### æ–¹å¼äºŒï¼šäº¤äº’å¼ç•Œé¢

```bash
# å¯åŠ¨äº¤äº’å¼ UI
./bin/cat-cafe --mode ui

# åœ¨äº¤äº’ç•Œé¢ä¸­ä½¿ç”¨ @ å‘é€ä»»åŠ¡
> @èŠ±èŠ± å®ç°ä¸€ä¸ª HTTP æœåŠ¡å™¨
> @è–‡è–‡ å®¡æŸ¥ä»£ç å®‰å…¨æ€§
> @å°ä¹” è®¾è®¡ç™»å½•é¡µé¢

# æŸ¥çœ‹å¯ç”¨å‘½ä»¤
> /help
> /list
> /exit
```

#### æ–¹å¼ä¸‰ï¼šå‘½ä»¤è¡Œæ¨¡å¼

```bash
# åˆ—å‡ºæ‰€æœ‰ Agent
./bin/cat-cafe --list

# å‘é€ä»»åŠ¡
./bin/cat-cafe --send --to èŠ±èŠ± --task "å®ç°ä¸€ä¸ª HTTP æœåŠ¡å™¨"
```

#### æ–¹å¼å››ï¼šAPI æ¨¡å¼

```bash
# æ‰‹åŠ¨å¯åŠ¨ API æœåŠ¡å™¨
./bin/cat-cafe --mode api --port 8080

# æ‰‹åŠ¨å¯åŠ¨ Agent Workersï¼ˆåœ¨ä¸åŒç»ˆç«¯ï¼‰
./bin/cat-cafe --mode agent --agent èŠ±èŠ±
./bin/cat-cafe --mode agent --agent è–‡è–‡
./bin/cat-cafe --mode agent --agent å°ä¹”
```

**API ä½¿ç”¨ç¤ºä¾‹ï¼š**

```bash
# 1. åˆ›å»ºä¼šè¯
curl -X POST http://localhost:8080/api/sessions

# 2. å‘é€æ¶ˆæ¯
curl -X POST http://localhost:8080/api/sessions/sess_xxx/messages \
  -H "Content-Type: application/json" \
  -d '{
    "content": "@èŠ±èŠ± ä½ å¥½",
    "mentionedCats": ["cat_001"]
  }'

# 3. è·å–æ¶ˆæ¯ï¼ˆåŒ…å« Agent å›å¤ï¼‰
curl http://localhost:8080/api/sessions/sess_xxx/messages
```

è¯¦ç»† API æ–‡æ¡£ï¼š`frontend/docs/API.md`

## ğŸ§ª è¿è¡Œæµ‹è¯•

```bash
make test
```

**æµ‹è¯•ç»“æœ**: âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ (8/8)

è¯¦è§ [TEST_REPORT.md](TEST_REPORT.md)

## ğŸ“ é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ src/                     # æºä»£ç 
â”‚   â”œâ”€â”€ main.go              # ä¸»ç¨‹åº
â”‚   â”œâ”€â”€ scheduler.go         # è°ƒåº¦å™¨
â”‚   â”œâ”€â”€ agent_worker.go      # Agent å·¥ä½œè¿›ç¨‹
â”‚   â”œâ”€â”€ user_interface.go    # äº¤äº’å¼ç”¨æˆ·ç•Œé¢
â”‚   â”œâ”€â”€ api_server.go        # API æœåŠ¡å™¨
â”‚   â”œâ”€â”€ logger.go            # æ—¥å¿—ç³»ç»Ÿ
â”‚   â”œâ”€â”€ minimal-claude.go    # Claude CLI åŒ…è£…å™¨
â”‚   â”œâ”€â”€ minimal-codex.go     # Codex CLI åŒ…è£…å™¨
â”‚   â”œâ”€â”€ minimal-gemini.go    # Gemini CLI åŒ…è£…å™¨
â”‚   â””â”€â”€ invoke.go            # CLI è°ƒç”¨æ ¸å¿ƒé€»è¾‘
â”œâ”€â”€ bin/                     # ç¼–è¯‘äº§ç‰©
â”œâ”€â”€ doc/                     # åç«¯æ–‡æ¡£
â”œâ”€â”€ frontend/                # å‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/                 # React æºä»£ç 
â”‚   â””â”€â”€ docs/                # å‰ç«¯æ–‡æ¡£
â”‚       â””â”€â”€ API.md           # API æ¥å£æ–‡æ¡£
â”œâ”€â”€ test/                    # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ prompts/                 # Agent ç³»ç»Ÿæç¤ºè¯
â”‚   â”œâ”€â”€ calico_cat.md        # èŠ±èŠ±çš„æç¤ºè¯
â”‚   â”œâ”€â”€ lihua_cat.md         # è–‡è–‡çš„æç¤ºè¯
â”‚   â””â”€â”€ silver_cat.md        # å°ä¹”çš„æç¤ºè¯
â”œâ”€â”€ config.yaml              # é…ç½®æ–‡ä»¶
â”œâ”€â”€ Makefile                 # ç¼–è¯‘è„šæœ¬
â”œâ”€â”€ start.sh                 # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ stop.sh                  # åœæ­¢è„šæœ¬
â”œâ”€â”€ test_api.sh              # API æµ‹è¯•è„šæœ¬
â””â”€â”€ chat_history.jsonl       # èŠå¤©è®°å½•
```

## ğŸ›  å·¥ä½œæµç¨‹

### æ¶æ„

```
å‰ç«¯ç•Œé¢ / API å®¢æˆ·ç«¯
    â†“
API æœåŠ¡å™¨ (SessionManager)
    â†“ å‘é€ä»»åŠ¡
è°ƒåº¦å™¨ (Scheduler)
    â†“
Redis Streams (ä»»åŠ¡é˜Ÿåˆ—)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  èŠ±èŠ±     â”‚  è–‡è–‡     â”‚  å°ä¹”     â”‚
â”‚ Worker   â”‚ Worker   â”‚ Worker   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“           â†“           â†“
æ‰§è¡Œä»»åŠ¡ (è°ƒç”¨ Claude/Codex/Gemini)
    â†“
Redis Streams (ç»“æœé˜Ÿåˆ—)
    â†“
API æœåŠ¡å™¨æ¥æ”¶ç»“æœ
    â†“
æ·»åŠ åˆ°ä¼šè¯æ¶ˆæ¯åˆ—è¡¨
    â†“
å‰ç«¯è½®è¯¢è·å–æ›´æ–°
```

### æ¶ˆæ¯æµç¨‹

1. **ç”¨æˆ·å‘é€æ¶ˆæ¯** â†’ API Server æ¥æ”¶
2. **æåŠçŒ«çŒ«** â†’ ä»»åŠ¡å‘é€åˆ°å¯¹åº” Agent çš„é˜Ÿåˆ—
3. **Agent å¤„ç†** â†’ è°ƒç”¨ AI æ¨¡å‹ç”Ÿæˆå›å¤
4. **ç»“æœè¿”å›** â†’ é€šè¿‡ç»“æœé˜Ÿåˆ—å‘é€å› API Server
5. **æ¶ˆæ¯æ›´æ–°** â†’ è‡ªåŠ¨æ·»åŠ åˆ°ä¼šè¯æ¶ˆæ¯åˆ—è¡¨
6. **å‰ç«¯è‡ªåŠ¨è·å–** â†’ æ™ºèƒ½è½®è¯¢è·å–æœ€æ–°æ¶ˆæ¯
   - å‘é€æ¶ˆæ¯åï¼š1 ç§’å¿«é€Ÿè½®è¯¢
   - æ”¶åˆ°å›å¤åï¼š3 ç§’æ…¢é€Ÿè½®è¯¢
   - æ— éœ€æ‰‹åŠ¨åˆ·æ–°é¡µé¢

## ğŸ“š æ–‡æ¡£

- [API.md](../frontend/docs/API.md) - API æ¥å£æ–‡æ¡£
- [COLLABORATION.md](COLLABORATION.md) - Agent åä½œæœºåˆ¶è¯¦è§£
- [SPEC.md](SPEC.md) - ç³»ç»Ÿè®¾è®¡è§„èŒƒ
- [TEST_SPEC.md](TEST_SPEC.md) - æµ‹è¯•è§„èŒƒ
- [TEST_REPORT.md](TEST_REPORT.md) - æµ‹è¯•æŠ¥å‘Š
- [USAGE_GUIDE.md](USAGE_GUIDE.md) - è¯¦ç»†ä½¿ç”¨æŒ‡å—

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- âœ… **RESTful API** - å®Œæ•´çš„ HTTP API æ¥å£ï¼Œæ”¯æŒå‰ç«¯é›†æˆ
- âœ… **ä¼šè¯ç®¡ç†** - å¤šä¼šè¯æ”¯æŒï¼Œæ¯ä¸ªä¼šè¯ç‹¬ç«‹çš„è°ƒåº¦å™¨
- âœ… **å®æ—¶å›å¤** - Agent å¤„ç†å®Œæˆåè‡ªåŠ¨å°†å›å¤æ·»åŠ åˆ°ä¼šè¯
- âœ… **æ™ºèƒ½è½®è¯¢** - å‰ç«¯è‡ªåŠ¨è·å–æ–°æ¶ˆæ¯ï¼Œå‘é€åå¿«é€Ÿè½®è¯¢ï¼Œæ”¶åˆ°å›å¤åæ…¢é€Ÿè½®è¯¢
- âœ… **äº¤äº’å¼ UI** - ä½¿ç”¨ @Agent è¯­æ³•è½»æ¾å‘é€ä»»åŠ¡
- âœ… **Agent åä½œ** - Agent å¯ä»¥ç›¸äº’è°ƒç”¨ï¼Œè‡ªåŠ¨åŒ–å·¥ä½œæµ
- âœ… **å¤´åƒæ˜¾ç¤º** - ç”¨æˆ·å’ŒçŒ«çŒ«éƒ½æœ‰ä¸“å±å¤´åƒï¼ŒçŒ«çŒ«äº’ç›¸è°ƒç”¨æ—¶å¤´åƒæ­£ç¡®æ˜¾ç¤º
- âœ… **@ æåŠèœå•** - è¾“å…¥ @ å¼¹å‡ºçŒ«çŒ«é€‰æ‹©èœå•ï¼Œæ”¯æŒå¤´åƒæ˜¾ç¤ºå’Œæ™ºèƒ½å…³é—­
- âœ… **Redis Streams æ¶ˆæ¯é˜Ÿåˆ—** - å¯é çš„æ¶ˆæ¯ä¼ é€’
- âœ… **æ— çŠ¶æ€é€šä¿¡** - Agent ç‹¬ç«‹è¿è¡Œï¼Œæ˜“äºæ‰©å±•
- âœ… **YAML é…ç½®** - çµæ´»çš„ Agent ç®¡ç†
- âœ… **é‡è¯•æœºåˆ¶** - å¤±è´¥ä»»åŠ¡è‡ªåŠ¨é‡è¯•
- âœ… **èŠå¤©è®°å½•** - æ¶ˆæ¯è½ç›˜åˆ° chat_history.jsonl
- âœ… **å®Œæ•´æµ‹è¯•** - 100% æµ‹è¯•è¦†ç›–

## ğŸ“ é…ç½®ç¤ºä¾‹

```yaml
agents:
  - name: "èŠ±èŠ±"
    pipe: "pipe_huahua"
    exec_cmd: "./minimal-claude"
    system_prompt_path: "prompts/calico_cat.md"

  - name: "è–‡è–‡"
    pipe: "pipe_weiwei"
    exec_cmd: "./minimal-codex"
    system_prompt_path: "prompts/lihua_cat.md"

  - name: "å°ä¹”"
    pipe: "pipe_xiaoqiao"
    exec_cmd: "./minimal-gemini"
    system_prompt_path: "prompts/silver_cat.md"

redis:
  addr: "localhost:6379"
  password: ""
  db: 0
```

## ğŸ§¹ æ¸…ç†

```bash
make clean
```

## ğŸ“„ è®¸å¯è¯

MIT License
